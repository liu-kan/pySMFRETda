# Install in windows

Since a dependent package of pySMFRETda is buggy under Windows, you are recommended just running pySMFRETda under [Docker for windows](https://docs.docker.com/docker-for-windows/install/) or in [WSL2](https://docs.microsoft.com/en-us/windows/wsl/about) in Windows now. If you want to run it natively under Windows, please follow steps below.

## Prerequisite
Install nanomsg, protobuf from [CONAN](https://conan.io). If you use pySMFRETda with [gSMFRETda](https://github.com/liu-kan/gSMFRETda), and build it from sources, you may already have it.
Install miniconda, and create new environment to run the programm.

## conda
* Install Miniconda3 for 64 bits. It should be easily found on https://docs.conda.io/en/latest/miniconda.html.
* Open the "Anaconda Command Prompt," which should be available in the start menu.
* In that command prompt window, use cd to change to the directory where you want to build.
* Now install all of the tools we need:
```bash
conda create --name pyda python=3
activate pyda
conda install numpy
```

## nanomsg-python
* Clone [nanomsg-python](https://github.com/tonysimpson/nanomsg-python) code.
* Change include_dirs in setup.py to the path of real nanomsg include path like ```include_dirs=[r'C:\.conan\6246bf\1\include',]```. It can be found in the file ```conanbuildinfo.cmake```, which was generated by conan install <gSMFRETda_src_dir>
* Copy nanomsg.lib from nanomsg lib path to nanomsg-python source dir.
* Install nanomsg-python in Anaconda Command Prompt with pyda environment, by
```bash
"c:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Auxiliary/Build/vcvars64.bat"
python setup.py build_ext --inplace --compiler=msvc
python setup.py install
```

## deap
* Clone [a patched deap](https://github.com/liu-kan/deap) branch, which has merge [PR 76](https://github.com/DEAP/deap/pull/76) from [@cmd-ntrf](https://github.com/cmd-ntrf)
* Install deap in Anaconda Command Prompt with pyda environment, by
```bash
python setup.py install
```

## FRETBursts (only if you use untils/*.py)
Build [FRETBursts](https://github.com/OpenSMFS/FRETBursts) from [@tritemio](https://github.com/tritemio) in [my repository](https://github.com/liu-kan/FRETBursts), which replace mpl.normpdf with scipy.stats.norm.pdf.
```bash
pip3 uninstall fretbursts # or conda uninstall fretbursts
git clone --depth=1 https://github.com/liu-kan/FRETBursts.git
cd FRETBursts
python3 setup.py build
python3 setup.py install
```